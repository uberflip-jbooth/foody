image: gitpod/workspace-full

tasks:
  - name: Terminal
  - name: Docker
    before: |
      export NEST_URL=$(gp url 5530)
      export LARAVEL_URL=$(gp url 8055)
      export REACT_URL=$(gp url 7755)
      chmod 777 public-api/storage/framework/cache/data
    init: make build && docker-compose up --no-start --build
    command: make up
    openMode: split-right
    
ports:
  - port: 4312 # MySQL
    onOpen: ignore
  - port: 5530 # private-api: Nest.js
    onOpen: ignore
  - port: 7755 # public-api: Laravel
    onOpen: open-preview
    visibility: public
  - port: 8055 # web-ui: React
    onOpen: ignore
